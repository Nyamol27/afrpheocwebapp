<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="header :: head"></head>
<head>
    <!-- Add Bootstrap 5 CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.7.0/dist/css/bootstrap.min.css">
    
    <!-- Add DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.min.css">

    <!-- Add jQuery and DataTables JS -->
    <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.6/js/dataTables.bootstrap5.min.js"></script>

</head>
<body data-topbar="dark">
    <header th:replace="header :: page-topbar"></header>
    <div th:replace="sidebar :: menu"></div>

    <div class="main-content">
        <div class="page-content">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-header justify-content-between d-flex align-items-center">
                                <h4 class="card-title">PHEOC Regional Roster - Trainer's Profile</h4>
                            </div>
                              <div class="card-body">
                                <!-- Display Trainer Details -->
                                <div>
                                   
									
									<table>
											<tr>
												<th colspan="2">
													    <h5>
													        <i class="fas fa-user"></i> Trainer Information
													    </h5>
													</th>
											</tr>
											<tr>
											<td>
												   <div>
															 <h1>
						    <p th:style="'font-weight: bold;'" th:text="${trainer.firstName + ' ' + trainer.lastName + ', ' + trainer.country}"></p>
						</h1>
						<p th:text="${'Status: ' + trainer.status}" th:class="${trainer.status == 'Available' ? 'badge rounded-pill badge-soft-success' : (trainer.status == 'Not yet filled' ? 'badge rounded-pill badge-soft-warning' : 'badge rounded-pill badge-soft-danger')}"></p>
						<p th:text="${'Advance notice: ' + trainer.notice}"></p>
						<p th:text="${'Last update: ' + trainer.lastUpdate}"></p>
						
						<div th:if="${trainer.cv != null}">
			    <p>
			        <a th:href="@{'/roster/downloadCV/' + ${trainer.id}}" target="_blank" th:download="'Trainer_CV.' + ${trainer.cvType}">
			            <i class="fas fa-download"></i> Download CV
			        </a>
			    </p>
			</div>
			<div th:if="${trainer.cv == null}">
			    <span class="badge rounded-pill badge-soft-info">No CV uploaded yet</span>
			</div>
			
						
						
						
						<button class="btn btn-primary w-sm" th:onclick="'navigateToEditPage(' + ${trainer.id} + ')'" >Update Trainer Details</button>
						<button class="btn btn-secondary w-sm" onclick="goBack()">Back</button>
						
						<script>
						    function navigateToEditPage(trainerId) {
						        // Redirect to the edit page for the specified trainer ID
						        window.location.href = "/roster/edit/" + trainerId;
						    }
						    
						    function goBack() {
						        // Navigate back to the previous page
						        window.history.back();
						    }
						</script>
									 


									</div>
											</td>
												<td>
												 <div>
									 	<p>
										    <i class="fas fa-envelope"></i> <span th:text="${'Email: ' + trainer.email}"></span>
										</p>
										<p>
										    <i class="fas fa-phone"></i> <span th:text="${'Telephone: ' + trainer.telephone}"></span>
										</p>

									 </div>
												
												</td>
											</tr>
									
									</table>

                                </div>
                                <hr>
                                <!-- Display Deployments -->
                                <div>
                                    <h5>Deployments History</h5>
                                   
                                    <div class="d-flex justify-content-end mb-3">
								        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addDeploymentModal">Add New Deployment</button>
								    </div>
                                    <table class="hover" id="dbdata" >
                                        <thead>
                                            <tr>
                                            	
                                                <th>Country</th>
                                                <th>Category</th>
                                                <th>Expertise</th>
                                                <th>Role / Position</th>
                                                <th>Start Date</th>
                                                <th>End Date</th>
                                                <th>Deploying entity</th>
                                                <th>Status</th>
                                                <th>Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr th:each="deployment : ${deployments}">
                                            
                                                <td th:text="${deployment.country}"></td>
                                                <td th:text="${deployment.type}"></td>
                                                <td th:text="${deployment.expertise}"></td>
                                                <td th:text="${deployment.role}"></td>
                                                <td th:text="${#temporals.format(deployment.startDate, 'yyyy-MM-dd')}"></td>
												<td th:text="${#temporals.format(deployment.endDate, 'yyyy-MM-dd')}"></td>
                                                <td th:text="${deployment.deployingOrganism}"></td>
                                                <td>
												    <span th:text="${deployment.status eq 'Completed' ? 'Completed' : 'Ongoing'}" 
												          th:class="${deployment.status eq 'Completed' ? 'badge rounded-pill badge-soft-success' : 'badge rounded-pill badge-soft-warning'}"></span>
												</td>
												<td>
													  <div class="dropdown">
									                    <a class="btn btn-link text-reset dropdown-toggle shadow-none" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
									                        <i class="uil uil-ellipsis-h"></i>
									                    </a>
									                    <ul class="dropdown-menu dropdown-menu-end">
									                        <li><a class="dropdown-item" th:href="@{'/deployments/edit/' + ${deployment.id}}">Edit</a></li>
									                        <li><a class="dropdown-item" href="#" onclick="confirmDeleteDeployment('${trainer.id}')">Delete</a></li>
									                    </ul>
									                </div>
												
												</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                     <div class="modal fade" id="addDeploymentModal" tabindex="-1" aria-labelledby="addDeploymentModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addDeploymentModalLabel">Add New Deployment</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                   <div class="modal-body">
                     
                   <div class="mb-3">
        <label for="deployment-country-input" class="form-label">Country:</label>
        <select class="form-select" id="deployment-country-input" required>
            <option value="" selected disabled>Select Country</option>
            <option th:each="country : ${T(net.pheocnetafr.africapheocnet.util.AutoFilledData).getAllAfricanCountries()}"
                    th:value="${country}" th:text="${country}"></option>
        </select>
    </div>
     <div class="mb-3">
        <label for="deployment-type-input" class="form-label">Category:</label>
        <select class="form-select" id="deployment-type-input" required>
            <option value="" selected disabled>Select Type</option>
            <option th:each="type : ${T(net.pheocnetafr.africapheocnet.util.AutoFilledData).getDeploymentTypeList()}"
                    th:value="${type}" th:text="${type}"></option>
        </select>
    </div>
     <div class="mb-3">
        <label for="deployment-expertise-input" class="form-label">Expertise:</label>
        <select class="form-select" id="deployment-expertise-input" required>
            <option value="" selected disabled>Select Expertise</option>
            <option th:each="expertise : ${T(net.pheocnetafr.africapheocnet.util.AutoFilledData).getExpertiseList()}"
                    th:value="${expertise}" th:text="${expertise}"></option>
        </select>
    </div>
    <div class="mb-3">
        <label for="deployment-role-input" class="form-label">Role / Position:</label>
        <input type="text" class="form-control" id="deployment-role-input" required>
    </div>


    <div class="mb-3">
        <label for="deployment-organism-input" class="form-label">Deploying Organism:</label>
        <select class="form-select" id="deployment-organism-input" required>
            <option value="" selected disabled>Select Deploying Organism</option>
            <option th:each="organism : ${T(net.pheocnetafr.africapheocnet.util.AutoFilledData).getDeploymentEntitiesList()}"
                    th:value="${organism}" th:text="${organism}"></option>
        </select>
    </div>

    <div class="mb-3">
        <label for="deployment-start-date-input" class="form-label">Start Date:</label>
        <input type="date" class="form-control" id="deployment-start-date-input" required>
    </div>

    <div class="mb-3">
        <label for="deployment-end-date-input" class="form-label">End Date:</label>
        <input type="date" class="form-control" id="deployment-end-date-input" required>
    </div>

      <div class="mb-3">
        <label for="deployment-status-input" class="form-label">Status:</label>
        <select class="form-select" id="deployment-status-input" required>
            <option value="" selected disabled>Select Status</option>
            <option th:each="status : ${T(net.pheocnetafr.africapheocnet.util.AutoFilledData).getDeploymentStatus()}"
                    th:value="${status}" th:text="${status}"></option>
        </select>
    </div>

<div id="alertBox" class="alert alert-warning alert-top-border alert-dismissible fade show" role="alert" style="display: none;">
								    <i class="uil uil-exclamation-triangle font-size-16 text-warning me-2"></i>
								   <span class="alert-message">A simple border warning alert</span>
								    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
								</div>
   
</div>
                   
                </div>
                
                <div class="modal-footer">
                 <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onclick="location.reload()">Close</button>
                     <button type="button" class="btn btn-primary" onclick="submitAddDeployment()">Add Deployment</button>
                </div>
            </div>
        </div>
    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <footer th:replace="footer :: footer-content"></footer>
    <footer th:replace="rightbar :: right-bar"></footer>
    
    <!-- JAVASCRIPT -->
    <script th:src="@{/libs/bootstrap/js/bootstrap.bundle.min.js}"></script>
    <script th:src="@{/libs/metismenujs/metismenujs.min.js}"></script>
    <script th:src="@{/libs/simplebar/simplebar.min.js}"></script>
    <script th:src="@{/libs/feather-icons/feather.min.js}"></script>
    
    
    <script th:src="@{/js/app.js}"></script>
    
    <script>
  new DataTable('#dbdata');
</script>
</body>
</html>