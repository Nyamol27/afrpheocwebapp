<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="header :: head"></head>
<head>
	

    <!-- Add Bootstrap 5 CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.7.0/dist/css/bootstrap.min.css">
    
    <!-- Add DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.min.css">

    <!-- Add jQuery and DataTables JS -->
    <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.6/js/dataTables.bootstrap5.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
</head>
<body data-topbar="dark">
    <header th:replace="header :: page-topbar"></header>
    <div th:replace="sidebar :: menu"></div>

    <div class="main-content">
        <div class="page-content">
        <div class="container-fluid">
                <div class="row">
                
                    <div class="col-lg-12">
                     <div class="card">
    <div class="card-header justify-content-between d-flex align-items-center">
        <h4 class="card-title">PHEOC Regional Roster</h4>
        <!-- Button to trigger the modal -->
<div class="row">
    <div class="col-md-3">
        <a href="#" class="btn btn-light" data-bs-toggle="modal" data-bs-target="#addTrainerModal">
            <i class="uil uil-plus me-1"></i> Add New
        </a>
    </div>
    <div class="col-md-3">
        <div class="input-group">
            <span class="input-group-text"><i class="uil uil-globe"></i></span>
            <select id="countryFilter" class="form-select" aria-label="Country Filter">
                <option value="">All Countries</option>
                <option th:each="country : ${T(net.pheocnetafr.africapheocnet.util.AutoFilledData).getAllAfricanCountries()}"
                    th:value="${country}" th:text="${country}"></option>
            </select>
        </div>
    </div>
    <div class="col-md-3">
        <div class="input-group">
            <span class="input-group-text"><i class="uil uil-book"></i></span>
            <select id="statusFilter" class="form-select" aria-label="Status Filter">
                <option value="">All Status</option>
                <option th:each="status : ${T(net.pheocnetafr.africapheocnet.util.AutoFilledData).getTrainerStatusList()}"
                    th:value="${status}" th:text="${status}"></option>
            </select>
        </div>
    </div>
    <div class="col-md-3">
        <div class="input-group">
            <button class="btn btn-success" onclick="exportTrainerToExcel()"><i class="bx bx-file"></i> Export to Excel</button>
        </div>
    </div>
</div>




							            

        <!-- Add New Trainer Modal -->
<div class="modal fade" id="addTrainerModal" tabindex="-1" role="dialog" aria-labelledby="addTrainerModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addTrainerModalLabel">Add New Trainer</h5>
                 <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="addTrainerForm">
                <div id="alertBox" class="alert alert-warning alert-top-border alert-dismissible fade show" role="alert"
				        style="display: none;">
				        <i class="uil uil-exclamation-triangle font-size-16 text-warning me-2"></i>
				        <span class="alert-message">A simple border warning alert</span>
				        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
				    </div>
            
                    <div class="mb-3">
                        <label for="addTrainer-firstname-input" class="form-label">First Name</label>
                        <input type="text" class="form-control" id="addTrainer-firstname-input" name="firstName" required>
                    </div>
                    <div class="mb-3">
                        <label for="addTrainer-lastname-input" class="form-label">Last Name</label>
                        <input type="text" class="form-control" id="addTrainer-lastname-input" name="lastName" required>
                    </div>
                    
<div class="mb-3">
    <label for="addTrainer-gender-input" class="form-label">Gender</label>
    <select class="form-select" id="addTrainer-gender-input" name="gender" required>
        <option value="" selected disabled>Select Gender</option>
        <option th:each="gender : ${T(net.pheocnetafr.africapheocnet.util.AutoFilledData).getGenderList()}"
                th:value="${gender}" th:text="${gender}"></option>
    </select>
</div>

<div class="mb-3">
    <label for="addTrainer-country-input" class="form-label">Country</label>
    <select class="form-select" id="addTrainer-country-input" name="country" required>
        <option value="" selected disabled>Select Country</option>
        <option th:each="country : ${T(net.pheocnetafr.africapheocnet.util.AutoFilledData).getAllAfricanCountries()}"
                th:value="${country}" th:text="${country}"></option>
    </select>
</div>



 <div class="mb-3">
                        <label for="addTrainer-position-input" class="form-label">Position</label>
                        <input type="text" class="form-control" id="addTrainer-position-input" name="position" required>
                    </div>

 <div class="form-floating form-floating-custom mb-2">
                                                    <select class="form-select" id="select-profession" name="profession" required>
                                                        <option value="" disabled selected>Select Profession</option>
                                                        <!-- Populate with professions -->
                                                        <th:block th:each="profession : ${T(net.pheocnetafr.africapheocnet.util.AutoFilledData).getProfessionList()}">
                                                            <option th:text="${profession}"></option>
                                                        </th:block>
                                                    </select>
                                                    <label for="select-profession">Profession</label>
                                                </div>
<div class="mb-3">
    <label for="addTrainer-organization-input" class="form-label">Organization</label>
    <select class="form-select" id="addTrainer-organization-input" name="organization" required>
        <option value="" selected disabled>Select Organization</option>
        <option th:each="organization : ${T(net.pheocnetafr.africapheocnet.util.AutoFilledData).getOrganizationList()}"
                th:value="${organization}" th:text="${organization}"></option>
    </select>
</div>

                   
                    <div class="mb-3">
                        <label for="addTrainer-email-input" class="form-label">Email</label>
                        <input type="email" class="form-control" id="addTrainer-email-input" name="email" required>
                    </div>
                 

<div class="mb-3">
    <label for="addTrainer-telephone-input" class="form-label">Telephone</label>
    <input type="tel" class="form-control" id="addTrainer-telephone-input" placeholder="Enter Telephone"
           pattern="[0-9]+" title="Please enter digits only" name="telephone" required>
</div>

<div class="mb-3">
    <label for="addTrainer-language-input" class="form-label">Language</label>
    <select class="form-select" id="addTrainer-language-input" name="language" required>
        <option value="" selected disabled>Select language</option>
        <option th:each="language : ${T(net.pheocnetafr.africapheocnet.util.AutoFilledData).getLanguageList()}"
                th:value="${language}" th:text="${language}"></option>
    </select>
</div>

                    <div class="modal-footer">
                <button type="button" class="btn btn-light w-sm" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary w-sm" onclick="submitAddTrainerForm()">Add</button>
            </div>
                </form>
            </div>
        </div>
    </div>
</div>




        
    </div>
    <div class="card-body">
        <table  id="dbdata" class="hover">
            <thead>
                <tr>
                   
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Cohort</th>
                    <th>Country</th>
                    <th>Position</th>
                    <th>Organization/ Department</th>
                    <th>Spoken Language</th>
                    <th>Status</th>
                    <th>Former Deployments</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody id="trainerTableBody" th:fragment="trainerTableBody">
                <tr th:each="trainer : ${trainers}">
                   
                    <td th:text="${trainer.firstName}"></td>
                    <td th:text="${trainer.lastName}"></td>
                    <td th:text="${trainer.cohort}"></td>
                    <td th:text="${trainer.country}"></td>
                     <td th:text="${trainer.position}"></td>
                      <td th:text="${trainer.organization}"></td>
                     <td th:text="${trainer.language}"></td>
                    <td>
    			<span th:text="${trainer.status}" 
      th:class="${trainer.status eq 'Available' ? 'badge rounded-pill badge-soft-success' : (trainer.status eq 'Not yet filled' ? 'badge rounded-pill badge-soft-warning' : 'badge rounded-pill badge-soft-danger')}"></span>
    			

				</td>
				
				<td>
				    <span th:if="${trainer.deployed}" class="badge badge-outline-info">Yes</span>
				    <span th:unless="${trainer.deployed}" class="badge badge-outline-warning">No</span>
				</td>
                    
                    

                    <td>
                    
                        <div class="dropdown">
                    <a class="btn btn-link text-reset dropdown-toggle shadow-none" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="uil uil-ellipsis-h"></i>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" th:href="@{'/roster/view/' + ${trainer.id}}">View</a></li>
                        <li><a class="dropdown-item" th:href="@{'/roster/edit/' + ${trainer.id}}">Edit</a></li>
                      <li><a class="dropdown-item"  th:onclick="'confirmDeleteTrainer(\'' + ${trainer.id} + '\')'">Delete</a></li>
                      
                    </ul>
                </div>
                        
                        
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

            
        </div>
    </div>
</div>

         </div>
         </div>
       
    
    <footer th:replace="footer :: footer-content"></footer>
    <footer th:replace="rightbar :: right-bar"></footer>
    
     <!-- JAVASCRIPT -->
	<script th:src="@{/libs/bootstrap/js/bootstrap.bundle.min.js}"></script>
	<script th:src="@{/libs/metismenujs/metismenujs.min.js}"></script>
	<script th:src="@{/libs/simplebar/simplebar.min.js}"></script>
	<script th:src="@{/libs/feather-icons/feather.min.js}"></script>
	
	
	<script th:src="@{/js/app.js}"></script>
	 <script>
  new DataTable('#dbdata');
  
  $(document).ready(function() {
      $('#dbdata').DataTable();

      // Handle filtering when selecting options in dropdowns
      $('#countryFilter, #statusFilter, #deploymnetFilter').on('change', function() {
          var country = $('#countryFilter').val();
          var status = $('#statusFilter').val();
          var deployed = $('#deploymentFilter').val();

          // Perform filtering based on selected options
          $('#dbdata').DataTable().search('').draw();
          $('#dbdata').DataTable().column(3).search(country).draw(); // Filter by country
          $('#dbdata').DataTable().column(7).search(status).draw(); // Filter by module
          $('#dbdata').DataTable().column(8).search(deployed).draw(); // Filter by role
      });
  });
</script>

</body>
</html>
