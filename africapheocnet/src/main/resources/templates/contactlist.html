<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="header :: head"></head>
<head>
    <!-- Add Bootstrap 5 CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.7.0/dist/css/bootstrap.min.css">
    
    <!-- Add DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.min.css">

    <!-- Add jQuery and DataTables JS -->
    <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.6/js/dataTables.bootstrap5.min.js"></script>

</head>
<body data-topbar="dark">
    <header th:replace="header :: page-topbar"></header>
    <div th:replace="sidebar :: menu"></div>

    <div class="main-content">
        <div class="page-content">
            <div class="container-fluid">
                <div class="row">
                
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-header justify-content-between d-flex align-items-center">
							    <h4 class="card-title">Contacts List</h4>
							    <div class="col-md-6 d-flex justify-content-end align-items-center">
							        <div class="d-flex flex-wrap align-items-start gap-2 mb-3">
							            <div>
							                <a href="#" class="btn btn-light" data-bs-toggle="modal" data-bs-target="#addContactModal">
							                    <i class="uil uil-plus me-1"></i> Add New
							                </a>
							            </div>
							            <div class="modal fade" id="addContactModal" tabindex="-1" aria-labelledby="addContactModalLabel" style="display: none;" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addContactModalLabel">Add Contact</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
            	<form id="addContactForm">
				    <div id="alertBox" class="alert alert-warning alert-top-border alert-dismissible fade show" role="alert"
				        style="display: none;">
				        <i class="uil uil-exclamation-triangle font-size-16 text-warning me-2"></i>
				        <span class="alert-message">A simple border warning alert</span>
				        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
				    </div>
				    <div class="mb-3">
				        <label for="addcontact-country-input" class="form-label">Country</label>
				        <select class="form-select" id="addcontact-country-input" name="country">
				            <option value="" selected disabled>Select Country</option>
				            <option th:each="country : ${countries}" th:value="${country}" th:text="${country}"></option>
				        </select>
				    </div>
				    <div class="mb-3">
				        <label for="addcontact-firstname-input" class="form-label">First Name</label>
				        <input type="text" class="form-control" id="addcontact-firstname-input" name="firstName" placeholder="Enter First Name">
				    </div>
				    <div class="mb-3">
				        <label for="addcontact-lastname-input" class="form-label">Last Name</label>
				        <input type="text" class="form-control" id="addcontact-lastname-input" name="lastName" placeholder="Enter Last Name">
				    </div>
				    <div class="mb-3">
				        <label for="addcontact-department-input" class="form-label">Department</label>
				        <input type="text" class="form-control" id="addcontact-department-input" name="department" placeholder="Enter Department">
				    </div>
				    <div class="mb-3">
				        <label for="addcontact-position-input" class="form-label">Position</label>
				        <input type="text" class="form-control" id="addcontact-position-input" name="position" placeholder="Enter Position">
				    </div>
				    <div class="mb-3">
				        <label for="addcontact-mobile-input" class="form-label">Mobile</label>
				        <input type="text" class="form-control" id="addcontact-mobile-input" name="mobile" placeholder="Enter Mobile">
				    </div>
				    <div class="mb-3">
				        <label for="addcontact-email-input" class="form-label">Email</label>
				        <input type="email" class="form-control" id="addcontact-email-input" name="email" placeholder="Enter Email">
				    </div>
				</form>
            	
            </div><!-- end modalbody -->
            <div class="modal-footer">
                <button type="button" class="btn btn-light w-sm" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary w-sm" onclick="submitAddContactForm()">Add</button>
            </div><!-- end modalfooter -->
        </div><!-- end modal content -->
    </div>
</div>
							            
							              <div th:if="${isAdmin}" class="col-md-2">
									        <button id="exportExcelButton" class="btn btn-success">
									            <i class="bx bx-file" onclick="exportContactToExcel()"></i> 
									        </button>
									    </div>
							        </div>
							    </div>
							</div>
                            
                     <div class="card-body">
                            
                    <table id="dbdata" class="hover">
                        <thead>
                            <tr >
                                <th>Country</th>
                                <th>First Name</th>
                                <th>Last Name</th>
                                <th>Position</th>
                                <th>Institution/ Organization</th>
                                <th >@Contact</th>
                                <th >Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="contact : ${contacts}">
                                <td th:text="${contact.country}"></td>
                                <td th:text="${contact.firstName}"></td>
                                <td th:text="${contact.lastName}"></td>
                                <td th:text="${contact.position}"></td>
                                <td th:text="${contact.department}"></td>
                                <td align="center"><h2><a th:href="'mailto:' + ${contact.email}"><i class="bx bx-mail-send nav-icon"></i></a></h2> </td>
                                <td> 
                                 <div class="dropdown">
                    <a class="btn btn-link text-reset dropdown-toggle shadow-none" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="uil uil-ellipsis-h"></i>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" th:href="@{'contacts/edit/' + ${contact.contactId}}">Edit</a></li>
                        <li><a class="dropdown-item delete-contact" th:data-contact-id="${contact.contactId}" >Delete</a></li>
                        
                    </ul>
                </div>
                                
                                </td>
                            </tr>
                        </tbody>
                    </table>
               
                            </div>
                            <!-- end card body -->
                        </div>
                        <!-- end card -->
                    </div>
                    <!-- end col -->
                </div>
            </div>
        </div>
    </div>
    
    <footer th:replace="footer :: footer-content"></footer>
    <footer th:replace="rightbar :: right-bar"></footer>
    
    <!-- JAVASCRIPT -->
    <script th:src="@{/libs/bootstrap/js/bootstrap.bundle.min.js}"></script>
    <script th:src="@{/libs/metismenujs/metismenujs.min.js}"></script>
    <script th:src="@{/libs/simplebar/simplebar.min.js}"></script>
    <script th:src="@{/libs/feather-icons/feather.min.js}"></script>
    
    <!-- swiper js -->
    <script th:src="@{/libs/swiper/swiper-bundle.min.js}"></script>
    
    <script th:src="@{/js/app.js}"></script>
    
   
  <script>
  new DataTable('#dbdata');
</script>

    
</body>
</html>
